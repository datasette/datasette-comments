var ye=Object.create;var Mt=Object.defineProperty;var be=Object.getOwnPropertyDescriptor;var we=Object.getOwnPropertyNames;var xe=Object.getPrototypeOf,Ce=Object.prototype.hasOwnProperty;var Te=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Se=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of we(t))!Ce.call(e,o)&&o!==n&&Mt(e,o,{get:()=>t[o],enumerable:!(i=be(t,o))||i.enumerable});return e};var ke=(e,t,n)=>(n=e!=null?ye(xe(e)):{},Se(t||!e||!e.__esModule?Mt(n,"default",{value:e,enumerable:!0}):n,e));var ue=Te((cn,ce)=>{var F=1e3,Z=F*60,V=Z*60,I=V*24,Le=I*7,Me=I*365.25;ce.exports=function(e,t){t=t||{};var n=typeof e;if(n==="string"&&e.length>0)return Ie(e);if(n==="number"&&isFinite(e))return t.long?$e(e):qe(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Ie(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),i=(t[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return n*Me;case"weeks":case"week":case"w":return n*Le;case"days":case"day":case"d":return n*I;case"hours":case"hour":case"hrs":case"hr":case"h":return n*V;case"minutes":case"minute":case"mins":case"min":case"m":return n*Z;case"seconds":case"second":case"secs":case"sec":case"s":return n*F;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function qe(e){var t=Math.abs(e);return t>=I?Math.round(e/I)+"d":t>=V?Math.round(e/V)+"h":t>=Z?Math.round(e/Z)+"m":t>=F?Math.round(e/F)+"s":e+"ms"}function $e(e){var t=Math.abs(e);return t>=I?lt(e,t,I,"day"):t>=V?lt(e,t,V,"hour"):t>=Z?lt(e,t,Z,"minute"):t>=F?lt(e,t,F,"second"):e+" ms"}function lt(e,t,n,i){var o=t>=n*1.5;return Math.round(e/n)+" "+i+(o?"s":"")}});var it,f,Ot,gt,M,It,Ft,ht,Zt,U={},Vt=[],Ee=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,yt=Array.isArray;function N(e,t){for(var n in t)e[n]=t[n];return e}function jt(e){var t=e.parentNode;t&&t.removeChild(e)}function d(e,t,n){var i,o,r,s={};for(r in t)r=="key"?i=t[r]:r=="ref"?o=t[r]:s[r]=t[r];if(arguments.length>2&&(s.children=arguments.length>3?it.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)s[r]===void 0&&(s[r]=e.defaultProps[r]);return tt(e,s,i,o,null)}function tt(e,t,n,i,o){var r={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:o??++Ot};return o==null&&f.vnode!=null&&f.vnode(r),r}function rt(e){return e.children}function O(e,t){this.props=e,this.context=t}function z(e,t){if(t==null)return e.__?z(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?z(e):null}function Bt(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Bt(e)}}function mt(e){(!e.__d&&(e.__d=!0)&&M.push(e)&&!et.__r++||It!==f.debounceRendering)&&((It=f.debounceRendering)||Ft)(et)}function et(){var e,t,n,i,o,r,s,u,l;for(M.sort(ht);e=M.shift();)e.__d&&(t=M.length,i=void 0,o=void 0,r=void 0,u=(s=(n=e).__v).__e,(l=n.__P)&&(i=[],o=[],(r=N({},s)).__v=s.__v+1,bt(l,s,r,n.__n,l.ownerSVGElement!==void 0,s.__h!=null?[u]:null,i,u??z(s),s.__h,o),Jt(i,s,o),s.__e!=u&&Bt(s)),M.length>t&&M.sort(ht));et.__r=0}function Wt(e,t,n,i,o,r,s,u,l,g,v){var a,h,c,_,m,q,y,x,E,S=0,T=i&&i.__k||Vt,W=T.length,P=W,$=t.length;for(n.__k=[],a=0;a<$;a++)(_=n.__k[a]=(_=t[a])==null||typeof _=="boolean"||typeof _=="function"?null:typeof _=="string"||typeof _=="number"||typeof _=="bigint"?tt(null,_,null,null,_):yt(_)?tt(rt,{children:_},null,null,null):_.__b>0?tt(_.type,_.props,_.key,_.ref?_.ref:null,_.__v):_)!=null?(_.__=n,_.__b=n.__b+1,(x=De(_,T,y=a+S,P))===-1?c=U:(c=T[x]||U,T[x]=void 0,P--),bt(e,_,c,o,r,s,u,l,g,v),m=_.__e,(h=_.ref)&&c.ref!=h&&(c.ref&&wt(c.ref,null,_),v.push(h,_.__c||m,_)),m!=null&&(q==null&&(q=m),(E=c===U||c.__v===null)?x==-1&&S--:x!==y&&(x===y+1?S++:x>y?P>$-y?S+=x-y:S--:S=x<y&&x==y-1?x-y:0),y=a+S,typeof _.type!="function"||x===y&&c.__k!==_.__k?typeof _.type=="function"||x===y&&!E?_.__d!==void 0?(l=_.__d,_.__d=void 0):l=m.nextSibling:l=Kt(e,m,l):l=zt(_,l,e),typeof n.type=="function"&&(n.__d=l))):(c=T[a])&&c.key==null&&c.__e&&(c.__e==l&&(l=z(c)),pt(c,c,!1),T[a]=null);for(n.__e=q,a=W;a--;)T[a]!=null&&(typeof n.type=="function"&&T[a].__e!=null&&T[a].__e==n.__d&&(n.__d=T[a].__e.nextSibling),pt(T[a],T[a]))}function zt(e,t,n){for(var i,o=e.__k,r=0;o&&r<o.length;r++)(i=o[r])&&(i.__=e,t=typeof i.type=="function"?zt(i,t,n):Kt(n,i.__e,t));return t}function Kt(e,t,n){return n==null||n.parentNode!==e?e.insertBefore(t,null):t==n&&t.parentNode!=null||e.insertBefore(t,n),t.nextSibling}function De(e,t,n,i){var o=e.key,r=e.type,s=n-1,u=n+1,l=t[n];if(l===null||l&&o==l.key&&r===l.type)return n;if(i>(l!=null?1:0))for(;s>=0||u<t.length;){if(s>=0){if((l=t[s])&&o==l.key&&r===l.type)return s;s--}if(u<t.length){if((l=t[u])&&o==l.key&&r===l.type)return u;u++}}return-1}function Ae(e,t,n,i,o){var r;for(r in n)r==="children"||r==="key"||r in t||nt(e,r,null,n[r],i);for(r in t)o&&typeof t[r]!="function"||r==="children"||r==="key"||r==="value"||r==="checked"||n[r]===t[r]||nt(e,r,t[r],n[r],i)}function qt(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Ee.test(t)?n:n+"px"}function nt(e,t,n,i,o){var r;t:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||qt(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||qt(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")r=t!==(t=t.replace(/(PointerCapture)$|Capture$/,"$1")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?i||e.addEventListener(t,r?Ut:$t,r):e.removeEventListener(t,r?Ut:$t,r);else if(t!=="dangerouslySetInnerHTML"){if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="width"&&t!=="height"&&t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t!=="rowSpan"&&t!=="colSpan"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,n))}}function $t(e){return this.l[e.type+!1](f.event?f.event(e):e)}function Ut(e){return this.l[e.type+!0](f.event?f.event(e):e)}function bt(e,t,n,i,o,r,s,u,l,g){var v,a,h,c,_,m,q,y,x,E,S,T,W,P,$,k=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(l=n.__h,u=t.__e=n.__e,t.__h=null,r=[u]),(v=f.__b)&&v(t);t:if(typeof k=="function")try{if(y=t.props,x=(v=k.contextType)&&i[v.__c],E=v?x?x.props.value:v.__:i,n.__c?q=(a=t.__c=n.__c).__=a.__E:("prototype"in k&&k.prototype.render?t.__c=a=new k(y,E):(t.__c=a=new O(y,E),a.constructor=k,a.render=Pe),x&&x.sub(a),a.props=y,a.state||(a.state={}),a.context=E,a.__n=i,h=a.__d=!0,a.__h=[],a._sb=[]),a.__s==null&&(a.__s=a.state),k.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=N({},a.__s)),N(a.__s,k.getDerivedStateFromProps(y,a.__s))),c=a.props,_=a.state,a.__v=t,h)k.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(k.getDerivedStateFromProps==null&&y!==c&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(y,E),!a.__e&&(a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(y,a.__s,E)===!1||t.__v===n.__v)){for(t.__v!==n.__v&&(a.props=y,a.state=a.__s,a.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(X){X&&(X.__=t)}),S=0;S<a._sb.length;S++)a.__h.push(a._sb[S]);a._sb=[],a.__h.length&&s.push(a);break t}a.componentWillUpdate!=null&&a.componentWillUpdate(y,a.__s,E),a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(c,_,m)})}if(a.context=E,a.props=y,a.__P=e,a.__e=!1,T=f.__r,W=0,"prototype"in k&&k.prototype.render){for(a.state=a.__s,a.__d=!1,T&&T(t),v=a.render(a.props,a.state,a.context),P=0;P<a._sb.length;P++)a.__h.push(a._sb[P]);a._sb=[]}else do a.__d=!1,T&&T(t),v=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++W<25);a.state=a.__s,a.getChildContext!=null&&(i=N(N({},i),a.getChildContext())),h||a.getSnapshotBeforeUpdate==null||(m=a.getSnapshotBeforeUpdate(c,_)),Wt(e,yt($=v!=null&&v.type===rt&&v.key==null?v.props.children:v)?$:[$],t,n,i,o,r,s,u,l,g),a.base=t.__e,t.__h=null,a.__h.length&&s.push(a),q&&(a.__E=a.__=null)}catch(X){t.__v=null,(l||r!=null)&&(t.__e=u,t.__h=!!l,r[r.indexOf(u)]=null),f.__e(X,t,n)}else r==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Re(n.__e,t,n,i,o,r,s,l,g);(v=f.diffed)&&v(t)}function Jt(e,t,n){for(var i=0;i<n.length;i++)wt(n[i],n[++i],n[++i]);f.__c&&f.__c(t,e),e.some(function(o){try{e=o.__h,o.__h=[],e.some(function(r){r.call(o)})}catch(r){f.__e(r,o.__v)}})}function Re(e,t,n,i,o,r,s,u,l){var g,v,a,h=n.props,c=t.props,_=t.type,m=0;if(_==="svg"&&(o=!0),r!=null){for(;m<r.length;m++)if((g=r[m])&&"setAttribute"in g==!!_&&(_?g.localName===_:g.nodeType===3)){e=g,r[m]=null;break}}if(e==null){if(_===null)return document.createTextNode(c);e=o?document.createElementNS("http://www.w3.org/2000/svg",_):document.createElement(_,c.is&&c),r=null,u=!1}if(_===null)h===c||u&&e.data===c||(e.data=c);else{if(r=r&&it.call(e.childNodes),v=(h=n.props||U).dangerouslySetInnerHTML,a=c.dangerouslySetInnerHTML,!u){if(r!=null)for(h={},m=0;m<e.attributes.length;m++)h[e.attributes[m].name]=e.attributes[m].value;(a||v)&&(a&&(v&&a.__html==v.__html||a.__html===e.innerHTML)||(e.innerHTML=a&&a.__html||""))}if(Ae(e,c,h,o,u),a)t.__k=[];else if(Wt(e,yt(m=t.props.children)?m:[m],t,n,i,o&&_!=="foreignObject",r,s,r?r[0]:n.__k&&z(n,0),u,l),r!=null)for(m=r.length;m--;)r[m]!=null&&jt(r[m]);u||("value"in c&&(m=c.value)!==void 0&&(m!==e.value||_==="progress"&&!m||_==="option"&&m!==h.value)&&nt(e,"value",m,h.value,!1),"checked"in c&&(m=c.checked)!==void 0&&m!==e.checked&&nt(e,"checked",m,h.checked,!1))}return e}function wt(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(i){f.__e(i,n)}}function pt(e,t,n){var i,o;if(f.unmount&&f.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||wt(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){f.__e(r,t)}i.base=i.__P=null,e.__c=void 0}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&pt(i[o],t,n||typeof e.type!="function");n||e.__e==null||jt(e.__e),e.__=e.__e=e.__d=void 0}function Pe(e,t,n){return this.constructor(e,n)}function Gt(e,t,n){var i,o,r,s;f.__&&f.__(e,t),o=(i=typeof n=="function")?null:n&&n.__k||t.__k,r=[],s=[],bt(t,e=(!i&&n||t).__k=d(rt,null,[e]),o||U,U,t.ownerSVGElement!==void 0,!i&&n?[n]:o?null:t.firstChild?it.call(t.childNodes):null,r,!i&&n?n:o?o.__e:t.firstChild,i,s),Jt(r,e,s)}function Yt(e,t){var n={__c:t="__cC"+Zt++,__:e,Consumer:function(i,o){return i.children(o)},Provider:function(i){var o,r;return this.getChildContext||(o=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(s){this.props.value!==s.value&&o.some(function(u){u.__e=!0,mt(u)})},this.sub=function(s){o.push(s);var u=s.componentWillUnmount;s.componentWillUnmount=function(){o.splice(o.indexOf(s),1),u&&u.call(s)}}),i.children}};return n.Provider.__=n.Consumer.contextType=n}it=Vt.slice,f={__e:function(e,t,n,i){for(var o,r,s;t=t.__;)if((o=t.__c)&&!o.__)try{if((r=o.constructor)&&r.getDerivedStateFromError!=null&&(o.setState(r.getDerivedStateFromError(e)),s=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,i||{}),s=o.__d),s)return o.__E=o}catch(u){e=u}throw e}},Ot=0,gt=function(e){return e!=null&&e.constructor===void 0},O.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=N({},this.state),typeof e=="function"&&(e=e(N({},n),this.props)),e&&N(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),mt(this))},O.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),mt(this))},O.prototype.render=rt,M=[],Ft=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ht=function(e,t){return e.__v.__b-t.__v.__b},et.__r=0,Zt=0;var K,w,xt,Qt,st=0,oe=[],ot=[],Xt=f.__b,te=f.__r,ee=f.diffed,ne=f.__c,ie=f.unmount;function Tt(e,t){f.__h&&f.__h(w,e,st||t),st=0;var n=w.__H||(w.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:ot}),n.__[e]}function R(e){return st=1,ct(se,e)}function ct(e,t,n){var i=Tt(K++,2);if(i.t=e,!i.__c&&(i.__=[n?n(t):se(void 0,t),function(u){var l=i.__N?i.__N[0]:i.__[0],g=i.t(l,u);l!==g&&(i.__N=[g,i.__[1]],i.__c.setState({}))}],i.__c=w,!w.u)){var o=function(u,l,g){if(!i.__c.__H)return!0;var v=i.__c.__H.__.filter(function(h){return h.__c});if(v.every(function(h){return!h.__N}))return!r||r.call(this,u,l,g);var a=!1;return v.forEach(function(h){if(h.__N){var c=h.__[0];h.__=h.__N,h.__N=void 0,c!==h.__[0]&&(a=!0)}}),!(!a&&i.__c.props===u)&&(!r||r.call(this,u,l,g))};w.u=!0;var r=w.shouldComponentUpdate,s=w.componentWillUpdate;w.componentWillUpdate=function(u,l,g){if(this.__e){var v=r;r=void 0,o(u,l,g),r=v}s&&s.call(this,u,l,g)},w.shouldComponentUpdate=o}return i.__N||i.__}function St(e,t){var n=Tt(K++,3);!f.__s&&ae(n.__H,t)&&(n.__=e,n.i=t,w.__H.__h.push(n))}function kt(e){return st=5,ut(function(){return{current:e}},[])}function ut(e,t){var n=Tt(K++,7);return ae(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function Ne(){for(var e;e=oe.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(at),e.__H.__h.forEach(Ct),e.__H.__h=[]}catch(t){e.__H.__h=[],f.__e(t,e.__v)}}f.__b=function(e){w=null,Xt&&Xt(e)},f.__r=function(e){te&&te(e),K=0;var t=(w=e.__c).__H;t&&(xt===w?(t.__h=[],w.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=ot,n.__N=n.i=void 0})):(t.__h.forEach(at),t.__h.forEach(Ct),t.__h=[],K=0)),xt=w},f.diffed=function(e){ee&&ee(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(oe.push(t)!==1&&Qt===f.requestAnimationFrame||((Qt=f.requestAnimationFrame)||He)(Ne)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==ot&&(n.__=n.__V),n.i=void 0,n.__V=ot})),xt=w=null},f.__c=function(e,t){t.some(function(n){try{n.__h.forEach(at),n.__h=n.__h.filter(function(i){return!i.__||Ct(i)})}catch(i){t.some(function(o){o.__h&&(o.__h=[])}),t=[],f.__e(i,n.__v)}}),ne&&ne(e,t)},f.unmount=function(e){ie&&ie(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{at(i)}catch(o){t=o}}),n.__H=void 0,t&&f.__e(t,n.__v))};var re=typeof requestAnimationFrame=="function";function He(e){var t,n=function(){clearTimeout(i),re&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);re&&(t=requestAnimationFrame(n))}function at(e){var t=w,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),w=t}function Ct(e){var t=w;e.__c=e.__(),w=t}function ae(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function se(e,t){return typeof t=="function"?t(e):t}var Et={COMMENT_ADD:'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M440-400h80v-120h120v-80H520v-120h-80v120H320v80h120v120ZM80-80v-720q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240H240L80-80Zm126-240h594v-480H160v525l46-45Zm-46 0v-480 480Z"/></svg>',CHECK_CIRCLE:'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="m424-296 282-282-56-56-226 226-114-114-56 56 170 170Zm56 216q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>',ADD_REACTION:'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M480-480Zm0 400q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q43 0 83 8.5t77 24.5v90q-35-20-75.5-31.5T480-800q-133 0-226.5 93.5T160-480q0 133 93.5 226.5T480-160q133 0 226.5-93.5T800-480q0-32-6.5-62T776-600h86q9 29 13.5 58.5T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm320-600v-80h-80v-80h80v-80h80v80h80v80h-80v80h-80ZM620-520q25 0 42.5-17.5T680-580q0-25-17.5-42.5T620-640q-25 0-42.5 17.5T560-580q0 25 17.5 42.5T620-520Zm-280 0q25 0 42.5-17.5T400-580q0-25-17.5-42.5T340-640q-25 0-42.5 17.5T280-580q0 25 17.5 42.5T340-520Zm140 260q68 0 123.5-38.5T684-400H276q25 63 80.5 101.5T480-260Z"/></svg>',COMMENT:'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M80-80v-720q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240H240L80-80Zm126-240h594v-480H160v525l46-45Zm-46 0v-480 480Z"/></svg>',TUNE:'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M440-120v-240h80v80h320v80H520v80h-80Zm-320-80v-80h240v80H120Zm160-160v-80H120v-80h160v-80h80v240h-80Zm160-80v-80h400v80H440Zm160-160v-240h80v80h160v80H680v80h-80Zm-480-80v-80h400v80H120Z"/></svg>'};async function D(e,t){let{method:n,data:i}=t??{};return fetch(`${e}`,{method:n,credentials:"include",headers:{"Content-Type":"application/json"},body:i?JSON.stringify(i):void 0}).then(o=>o.json())}var J=class{static async threadNew(t,n){return D("/-/datasette-comments/api/thread/new",{method:"POST",data:{...t,comment:n}})}static async tableViewThreads(t,n,i){return D("/-/datasette-comments/api/threads/table_view",{method:"POST",data:{database:t,table:n,rowids:i}})}static async rowViewThreads(t,n,i){return D("/-/datasette-comments/api/threads/row_view",{method:"POST",data:{database:t,table:n,rowids:i}})}static async threadMarkResolved(t){return D("/-/datasette-comments/api/threads/mark_resolved",{method:"POST",data:{thread_id:t}})}static async threadComments(t){return D(`/-/datasette-comments/api/thread/comments/${t}`)}static async commentAdd(t,n){return D("/-/datasette-comments/api/thread/comment/add",{method:"POST",data:{thread_id:t,contents:n}})}static async reactionAdd(t,n){return D("/-/datasette-comments/api/reaction/add",{method:"POST",data:{comment_id:t,reaction:n}})}static async reactionRemove(t,n){return D("/-/datasette-comments/api/reaction/remove",{method:"POST",data:{comment_id:t,reaction:n}})}static async reactions(t){return D(`/-/datasette-comments/api/reactions/${t}`)}static async autocomplete_mentions(t){return D(`/-/datasette-comments/api/autocomplete/mentions?prefix=${encodeURIComponent(t)}`)}static async activitySearch(t){let n=new URLSearchParams;return n.set("searchComments",t.searchComments),t.containsTags.forEach(i=>n.append("containsTag",i)),n.set("isResolved",t.isResolved?"1":"0"),t.author&&n.set("author",t.author),t.database&&n.set("database",t.database),t.table&&n.set("table",t.table),D(`/-/datasette-comments/api/activity_search?${n}`)}};function Dt(e,t){switch(t.type){case"init":return{...e,isLoading:!0};case"failure":return{...e,isLoading:!1,error:t.error};case"success":return{...e,isLoading:!1,data:t.data}}}var le=ke(ue());function At(e){return d("span",{style:"font-size: .8rem",title:e.timestamp},e.duration_ms<1e3?"Just now":`${(0,le.default)(e.duration_ms,{long:!0})} ago`)}var de="data:image/svg+xml,%3Csvg width='32' height='32' viewBox='0 0 32 32' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cmask id='mask0_136_16' style='mask-type:alpha' maskUnits='userSpaceOnUse' x='0' y='0' width='32' height='32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%23D9D9D9'/%3E%3C/mask%3E%3Cg mask='url(%23mask0_136_16)'%3E%3Crect width='32' height='32' fill='%23D9D9D9'/%3E%3Ccircle cx='16' cy='13' r='7' fill='%236D6D6D'/%3E%3Ccircle cx='16' cy='13' r='7' fill='%236D6D6D'/%3E%3Ccircle cx='16' cy='13' r='7' fill='%236D6D6D'/%3E%3Ccircle cx='16' cy='13' r='7' fill='%236D6D6D'/%3E%3Cpath d='M30 32.5C23.25 32.5 23.9558 32.5 16.5 32.5C9.04416 32.5 9.75 32.5 3 32.5C3 25.0442 9.04416 19 16.5 19C23.9558 19 30 25.0442 30 32.5Z' fill='%236D6D6D'/%3E%3Cpath d='M30 32.5C23.25 32.5 23.9558 32.5 16.5 32.5C9.04416 32.5 9.75 32.5 3 32.5C3 25.0442 9.04416 19 16.5 19C23.9558 19 30 25.0442 30 32.5Z' fill='%236D6D6D'/%3E%3Cpath d='M30 32.5C23.25 32.5 23.9558 32.5 16.5 32.5C9.04416 32.5 9.75 32.5 3 32.5C3 25.0442 9.04416 19 16.5 19C23.9558 19 30 25.0442 30 32.5Z' fill='%236D6D6D'/%3E%3Cpath d='M30 32.5C23.25 32.5 23.9558 32.5 16.5 32.5C9.04416 32.5 9.75 32.5 3 32.5C3 25.0442 9.04416 19 16.5 19C23.9558 19 30 25.0442 30 32.5Z' fill='%236D6D6D'/%3E%3C/g%3E%3C/svg%3E%0A",Tn=Yt({actor_id:"",name:"",profile_photo_url:"",username:null});function _t(){throw new Error("Cycle detected")}var Ue=Symbol.for("preact-signals");function ft(){if(H>1)H--;else{for(var e,t=!1;G!==void 0;){var n=G;for(G=void 0,Rt++;n!==void 0;){var i=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&fe(n))try{n.c()}catch(o){t||(e=o,t=!0)}n=i}}if(Rt=0,H--,t)throw e}}function Pt(e){if(H>0)return e();H++;try{return e()}finally{ft()}}var b=void 0;var G=void 0,H=0,Rt=0,dt=0;function _e(e){if(b!==void 0){var t=e.n;if(t===void 0||t.t!==b)return t={i:0,S:e,p:b.s,n:void 0,t:b,e:void 0,x:void 0,r:t},b.s!==void 0&&(b.s.n=t),b.s=t,e.n=t,32&b.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=b.s,t.n=void 0,b.s.n=t,b.s=t),t}}function C(e){this.v=e,this.i=0,this.n=void 0,this.t=void 0}C.prototype.brand=Ue;C.prototype.h=function(){return!0};C.prototype.S=function(e){this.t!==e&&e.e===void 0&&(e.x=this.t,this.t!==void 0&&(this.t.e=e),this.t=e)};C.prototype.U=function(e){if(this.t!==void 0){var t=e.e,n=e.x;t!==void 0&&(t.x=n,e.e=void 0),n!==void 0&&(n.e=t,e.x=void 0),e===this.t&&(this.t=n)}};C.prototype.subscribe=function(e){var t=this;return j(function(){var n=t.value,i=32&this.f;this.f&=-33;try{e(n)}finally{this.f|=i}})};C.prototype.valueOf=function(){return this.value};C.prototype.toString=function(){return this.value+""};C.prototype.toJSON=function(){return this.value};C.prototype.peek=function(){return this.v};Object.defineProperty(C.prototype,"value",{get:function(){var e=_e(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(b instanceof L&&function(){throw new Error("Computed cannot have side-effects")}(),e!==this.v){Rt>100&&_t(),this.v=e,this.i++,dt++,H++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{ft()}}}});function A(e){return new C(e)}function fe(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function ve(e){for(var t=e.s;t!==void 0;t=t.n){var n=t.S.n;if(n!==void 0&&(t.r=n),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function he(e){for(var t=e.s,n=void 0;t!==void 0;){var i=t.p;t.i===-1?(t.S.U(t),i!==void 0&&(i.n=t.n),t.n!==void 0&&(t.n.p=i)):n=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=i}e.s=n}function L(e){C.call(this,void 0),this.x=e,this.s=void 0,this.g=dt-1,this.f=4}(L.prototype=new C).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===dt))return!0;if(this.g=dt,this.f|=1,this.i>0&&!fe(this))return this.f&=-2,!0;var e=b;try{ve(this),b=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return b=e,he(this),this.f&=-2,!0};L.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}C.prototype.S.call(this,e)};L.prototype.U=function(e){if(this.t!==void 0&&(C.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};L.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};L.prototype.peek=function(){if(this.h()||_t(),16&this.f)throw this.v;return this.v};Object.defineProperty(L.prototype,"value",{get:function(){1&this.f&&_t();var e=_e(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function Y(e){return new L(e)}function me(e){var t=e.u;if(e.u=void 0,typeof t=="function"){H++;var n=b;b=void 0;try{t()}catch(i){throw e.f&=-2,e.f|=8,Nt(e),i}finally{b=n,ft()}}}function Nt(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,me(e)}function Oe(e){if(b!==this)throw new Error("Out-of-order effect");he(this),b=e,this.f&=-2,8&this.f&&Nt(this),ft()}function Q(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}Q.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};Q.prototype.S=function(){1&this.f&&_t(),this.f|=1,this.f&=-9,me(this),ve(this),H++;var e=b;return b=this,Oe.bind(this,e)};Q.prototype.N=function(){2&this.f||(this.f|=2,this.o=G,G=this)};Q.prototype.d=function(){this.f|=8,1&this.f||Nt(this)};function j(e){var t=new Q(e);try{t.c()}catch(n){throw t.d(),n}return t.d.bind(t)}var Lt,Ht;function B(e,t){f[e]=t.bind(null,f[e]||function(){})}function vt(e){Ht&&Ht(),Ht=e&&e.S()}function pe(e){var t=this,n=e.data,i=Ze(n);i.value=n;var o=ut(function(){for(var r=t.__v;r=r.__;)if(r.__c){r.__c.__$f|=4;break}return t.__$u.c=function(){var s;!gt(o.peek())&&((s=t.base)==null?void 0:s.nodeType)===3?t.base.data=o.peek():(t.__$f|=1,t.setState({}))},Y(function(){var s=i.value.value;return s===0?0:s===!0?"":s||""})},[]);return o.value}pe.displayName="_st";Object.defineProperties(C.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:pe},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});B("__b",function(e,t){if(typeof t.type=="string"){var n,i=t.props;for(var o in i)if(o!=="children"){var r=i[o];r instanceof C&&(n||(t.__np=n={}),n[o]=r,i[o]=r.peek())}}e(t)});B("__r",function(e,t){vt();var n,i=t.__c;i&&(i.__$f&=-2,(n=i.__$u)===void 0&&(i.__$u=n=function(o){var r;return j(function(){r=this}),r.c=function(){i.__$f|=1,i.setState({})},r}())),Lt=i,vt(n),e(t)});B("__e",function(e,t,n,i){vt(),Lt=void 0,e(t,n,i)});B("diffed",function(e,t){vt(),Lt=void 0;var n;if(typeof t.type=="string"&&(n=t.__e)){var i=t.__np,o=t.props;if(i){var r=n.U;if(r)for(var s in r){var u=r[s];u!==void 0&&!(s in i)&&(u.d(),r[s]=void 0)}else n.U=r={};for(var l in i){var g=r[l],v=i[l];g===void 0?(g=Fe(n,l,v,o),r[l]=g):g.o(v,o)}}}e(t)});function Fe(e,t,n,i){var o=t in e&&e.ownerSVGElement===void 0,r=A(n);return{o:function(s,u){r.value=s,i=u},d:j(function(){var s=r.value.value;i[t]!==s&&(i[t]=s,o?e[t]=s:s?e.setAttribute(t,s):e.removeAttribute(t))})}}B("unmount",function(e,t){if(typeof t.type=="string"){var n=t.__e;if(n){var i=n.U;if(i){n.U=void 0;for(var o in i){var r=i[o];r&&r.d()}}}}else{var s=t.__c;if(s){var u=s.__$u;u&&(s.__$u=void 0,u.d())}}e(t)});B("__h",function(e,t,n,i){(i<3||i===9)&&(t.__$f|=2),e(t,n,i)});O.prototype.shouldComponentUpdate=function(e,t){var n=this.__$u;if(!(n&&n.s!==void 0||4&this.__$f)||3&this.__$f)return!0;for(var i in t)return!0;for(var o in e)if(o!=="__source"&&e[o]!==this.props[o])return!0;for(var r in this.props)if(!(r in e))return!0;return!1};function Ze(e){return ut(function(){return A(e)},[])}function ge(e){var t=kt(e);t.current=e,St(function(){return j(function(){return t.current()})},[])}function Ve({target_type:e,target_database:t,target_table:n,target_row_ids:i,target_columns:o}){switch(e){case"database":return t;case"table":return`${t}/${n}`;case"columns":return`${t}/${o}`;case"row":return`${t}/${n}/${JSON.parse(i).join(",")}`;case"value":return`${t}/${n}/${o}/${JSON.parse(i).join(",")}`}}function je(e){let{author:t,contents:n,created_at:i,created_duration_seconds:o}=e.data,r=Ve(e.data);return d("div",{style:{position:"relative",borderBottom:e.isLastRead?"1px solid red":null,paddingBottom:".5rem"}},d("span",null,d("div",null,d("a",{style:"font-weight:600; display: inline;",href:t.username?`/-/datasette-comments/activity?author=${t.username}`:void 0},d("img",{src:t.profile_photo_url||de,width:"14px",style:"border-radius: 50%; margin-right: 2px; display: inline;"}),t.name)," ","on"," ",d("b",{style:"font-weight: 600;"},d("a",{href:"/"+r},e.data.target_label??r))," ",d(At,{duration_ms:o*1e3,timestamp:i})),d("div",{style:"padding-left: 1rem;"},d("i",{style:"font-style: italic"},n))),e.isLastRead&&d("div",{style:"position: absolute; right: 0; bottom: 0; background: red; color: white; font-size: 12px; line-height: 12px; padding: 2px 6px"},"\u2303New"))}var p={searchComments:A(""),author:A(null),database:A(null),table:A(null),containsTag:A([]),isResolved:A(!1)};function Be(e){let t=new URL(e).searchParams;return t.has("author")&&(p.author.value=t.get("author")),t.has("database")&&(p.database.value=t.get("database")),t.has("table")&&(p.table.value=t.get("table")),t.has("sc")&&(p.searchComments.value=t.get("sc")),t.has("tag")&&(p.containsTag.value=t.getAll("tag")),t.has("resolved")&&(p.isResolved.value=t.get("resolved")==="1"),t.has("author")||t.has("database")||t.has("table")||t.has("sc")||t.has("tag")||t.has("resolved")}var We=Be(window.location.href),ze=Y(()=>{let e=new URLSearchParams;return p.searchComments.value.length&&e.set("sc",p.searchComments.value),p.author.value&&e.set("author",p.author.value),p.database.value&&e.set("database",p.database.value),p.table.value&&e.set("table",p.table.value),e.set("resolved",p.isResolved.value?"1":"0"),p.containsTag.value.forEach(t=>e.append("tag",t)),e});function Ke(){let[e,t]=R(p.searchComments.value),[n,i]=R(p.author.value),[o,r]=R(p.database.value),[s,u]=R(p.table.value),[l,g]=R(p.containsTag.value.join(",")),[v,a]=R(p.isResolved.value);function h(){Pt(()=>{p.searchComments.value=e,p.containsTag.value=l.length?l.split(","):[],p.isResolved.value=v,p.author.value=n,p.database.value=o,p.table.value=s})}return d("div",{className:"activity-search"},d("div",{className:"activity-search-field"},d("label",{for:"search-comments"},"Search comments"),d("input",{id:"search-comments",type:"text",value:e,onKeyDown:c=>c.key==="Enter"&&h(),onInput:c=>{t(c.target.value)}})),d("div",{className:"activity-search-field"},d("label",{for:"author"},"Author"),d("input",{id:"author",type:"text",value:n,onKeyDown:c=>c.key==="Enter"&&h(),onInput:c=>{i(c.target.value)}})),d("div",{className:"activity-search-field"},d("label",{for:"database"},"Database"),d("input",{id:"database",type:"text",value:o,onKeyDown:c=>c.key==="Enter"&&h(),onInput:c=>{r(c.target.value)}})),d("div",{className:"activity-search-field"},d("label",{for:"table"},"Table"),d("input",{id:"table",type:"text",value:s,onKeyDown:c=>c.key==="Enter"&&h(),onInput:c=>{u(c.target.value)}})),d("div",{className:"activity-search-field"},d("label",{for:"containing-tags"},"Containing tags"),d("div",null,d("input",{id:"containing-tags",type:"text",value:l,onKeyDown:c=>c.key==="Enter"&&h(),onInput:c=>g(c.target.value)}),d("div",{class:"help"},"Seperate tags with commas"))),d("div",{className:"activity-search-field"},d("label",{for:"is-resolved"},"Is resolved"),d("div",null,d("input",{id:"is-resolved",type:"checkbox",checked:v,onInput:c=>{a(c.target.checked)}}))),d("div",{className:"activity-search-footer"},d("button",{onClick:h},"Submit"),d("div",null,d("a",{href:`?${ze}`},"Link to this search"))))}function Je(){let[e,t]=R(We),[n,i]=ct(Dt,{isLoading:!0});return ge(()=>{i({type:"init"}),J.activitySearch({searchComments:p.searchComments.value,containsTags:p.containsTag.value,isResolved:p.isResolved.value,author:p.author.value,database:p.database.value,table:p.table.value}).then(o=>{i({type:"success",data:o.data})}).catch(o=>{i({type:"failure",error:o.toString()})})}),d("div",{className:"datasette-comments-activity-view"},d("div",{className:"header"},d("h1",null,"Comments"),d("button",{class:"filter",dangerouslySetInnerHTML:{__html:Et.TUNE},onClick:()=>t(o=>!o)})),e?d(Ke,null):null,d("div",null,n.isLoading?"Loading...":n.error?d("div",null,"Unknown error occurred."):n.data.length>0?n.data.map((o,r)=>d(je,{data:o,isLastRead:!1})):d("p",null,"No comments yet")))}async function Ge(){Gt(d(Je,null),document.querySelector("#root"))}document.addEventListener("DOMContentLoaded",Ge);
